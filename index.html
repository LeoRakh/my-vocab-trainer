
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–õ–∏—á–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä —Å–ª–æ–≤</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      padding: 20px;
      text-align: center;
    }

    h1 {
      margin-bottom: 10px;
    }

    .input-group {
      margin: 10px 0;
    }

    input[type="text"] {
      padding: 10px;
      font-size: 16px;
      width: 160px;
      margin-right: 10px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px 5px;
      cursor: pointer;
    }

    #card {
      background: white;
      padding: 40px;
      font-size: 32px;
      margin: 30px auto;
      width: 300px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    #result {
      font-size: 20px;
      margin-top: 20px;
    }

    #upload {
      margin-top: 10px;
    }
  </style>

  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</head>
<body>

<h1>–ú–æ–π —Å–ª–æ–≤–∞—Ä—å</h1>

<div class="input-group">
  <input type="text" id="wordInput" placeholder="–°–ª–æ–≤–æ (–∏–≤—Ä–∏—Ç —Å ◊†◊ô◊ß◊ï◊ì)">
  <input type="text" id="translationInput" placeholder="–ü–µ—Ä–µ–≤–æ–¥ (—Ä—É—Å)">
  <button onclick="addWord()">–î–æ–±–∞–≤–∏—Ç—å</button>
</div>

<div class="input-group">
  <input type="file" id="upload" accept=".csv">
  <button onclick="loadCSV()">–ó–∞–≥—Ä—É–∑–∏—Ç—å .csv</button>
</div>

<div class="input-group">
  <button onclick="exportCSV()">üì§ –°–∫–∞—á–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å</button>
  <button onclick="clearVocabulary()">üßπ –û—á–∏—Å—Ç–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å</button>
</div>

<button onclick="startTraining()">‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>

<div id="card" style="display:none;"></div>

<div>
  <button onclick="markAnswer(false)" id="btnNo" style="display:none;">–ù–µ –∑–Ω–∞—é</button>
  <button onclick="markAnswer(true)" id="btnYes" style="display:none;">–Ø –∑–Ω–∞—é</button>
</div>

<div id="result"></div>

<script>
  let wordList = JSON.parse(localStorage.getItem("myWords") || "[]");
  let trainingSet = [];
  let currentIndex = 0;
  let knownCount = 0;

  function saveWords() {
    localStorage.setItem("myWords", JSON.stringify(wordList));
  }

  function addWord() {
    const word = document.getElementById('wordInput').value.trim();
    const translation = document.getElementById('translationInput').value.trim();
    if (word && translation) {
      wordList.push({ word, translation });
      saveWords();
      document.getElementById('wordInput').value = '';
      document.getElementById('translationInput').value = '';
      alert("–°–ª–æ–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!");
    }
  }

  function loadCSV() {
    const file = document.getElementById('upload').files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      const lines = e.target.result.split(/\r?\n/);
      for (const line of lines) {
        const [word, translation] = line.split(',');
        if (word && translation) {
          wordList.push({ word: word.trim(), translation: translation.trim() });
        }
      }
      saveWords();
      alert("–°–ª–æ–≤–∞ –∏–∑ —Ñ–∞–π–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã!");
    };
    reader.readAsText(file);
  }

  function exportCSV() {
    if (wordList.length === 0) {
      alert("–°–ª–æ–≤–∞—Ä—å –ø—É—Å—Ç.");
      return;
    }
    let csv = "word,translation\n";
    for (const entry of wordList) {
      csv += `${entry.word},${entry.translation}\n`;
    }
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "my_vocab.csv";
    link.click();
  }

  function clearVocabulary() {
    if (confirm("–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞?")) {
      wordList = [];
      saveWords();
      alert("–°–ª–æ–≤–∞—Ä—å –æ—á–∏—â–µ–Ω.");
    }
  }

  function startTraining() {
    if (wordList.length < 1) {
      alert("–ù–µ—Ç —Å–ª–æ–≤ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ.");
      return;
    }
    trainingSet = [...wordList].sort(() => 0.5 - Math.random()).slice(0, 10);
    currentIndex = 0;
    knownCount = 0;
    document.getElementById('result').textContent = '';
    document.getElementById('btnYes').style.display = "inline-block";
    document.getElementById('btnNo').style.display = "inline-block";
    showCard();
  }

  function showCard() {
    if (currentIndex < trainingSet.length) {
      const word = trainingSet[currentIndex].word;
      document.getElementById('card').textContent = word;
      document.getElementById('card').style.display = "block";
    } else {
      document.getElementById('card').style.display = "none";
      document.getElementById('btnYes').style.display = "none";
      document.getElementById('btnNo').style.display = "none";
      document.getElementById('result').innerHTML = \`
        <p>–í—ã –∑–Ω–∞–µ—Ç–µ \${knownCount} –∏–∑ \${trainingSet.length} —Å–ª–æ–≤.</p>
      \`;
    }
  }

  function markAnswer(isKnown) {
    if (isKnown) knownCount++;
    currentIndex++;
    showCard();
  }
<<script>
  let words = [];

  function addWord() {
    const word = document.getElementById('word').value.trim();
    const translation = document.getElementById('translation').value.trim();
    if (word && translation) {
      words.push({ word, translation });
      document.getElementById('word').value = '';
      document.getElementById('translation').value = '';
      alert('–°–ª–æ–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!');
    }
  }

  function downloadCSV() {
    const csv = words.map(w => `${w.word},${w.translation}`).join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'vocab.csv';
    a.click();
  }

  function clearWords() {
    words = [];
    alert('–°–ª–æ–≤–∞—Ä—å –æ—á–∏—â–µ–Ω!');
  }

  function startTraining() {
    if (words.length === 0) {
      alert('–°–ª–æ–≤–∞—Ä—å –ø—É—Å—Ç!');
      return;
    }
    currentIndex = 0;
    knownCount = 0;
    document.getElementById('card').style.display = 'block';
    showCard();
  }

  let currentIndex = 0;
  let knownCount = 0;

  function showCard() {
    const word = words[currentIndex];
    if (!word) {
      document.getElementById('card').innerHTML = `<p>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ó–Ω–∞–Ω–∏–µ —Å–ª–æ–≤: ${knownCount}/${words.length}</p>`;
      return;
    }

    document.getElementById('card').innerHTML = `
      <p><strong>${word.word}</strong></p>
      <button onclick="markAnswer(true)">‚úÖ –ó–Ω–∞—é</button>
      <button onclick="markAnswer(false)">‚ùå –ù–µ –∑–Ω–∞—é</button>
    `;
  }

  function markAnswer(isKnown) {
    if (isKnown) knownCount++;
    currentIndex++;
    showCard();
  }

  function loadCSVFromFile(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      const lines = e.target.result.split('\n');
      for (let line of lines) {
        const [word, translation] = line.split(',');
        if (word && translation) {
          words.push({ word: word.trim(), translation: translation.trim() });
        }
      }
      alert('–°–ª–æ–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞!');
    };
    reader.readAsText(file);
  }
</script>>

</body>
</html>
